<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Boss Tracker</title>
</head>
<body>
    <h1>Boss Tracker</h1>
    <div id="boss-list"></div>

    <script>
        const bossContainer = document.getElementById("boss-list");

        // SSE connection to stream live updates
        const evtSource = new EventSource("/api/stream");
        evtSource.onmessage = function(event) {
            const bosses = JSON.parse(event.data);
            bossContainer.innerHTML = "";

            bosses.forEach(boss => {
                const div = document.createElement("div");
                div.innerHTML = `
                    <strong>${boss.name}</strong> - Status: <span id="status-${boss._id}">${boss.status}</span>
                    <button onclick="updateBoss('${boss._id}')">Toggle Status</button>
                `;
                bossContainer.appendChild(div);
            });
        };

        // Update boss status
        async function updateBoss(id) {
            const currentStatus = document.getElementById(`status-${id}`).textContent;
            const newStatus = currentStatus === "Alive" ? "Dead" : "Alive";

            await fetch("/api/updateBoss", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ id, status: newStatus })
            });
            // SSE will automatically push updated data, no reload needed
        }
    </script>
</body>
</html>
